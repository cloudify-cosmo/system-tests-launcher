<!doctype html>
<html ng-app="app">

  <head>
    <title>Cloudify System Tests Launcher</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.8/angular.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/3.0.2/js-yaml.js"></script>
    <script src="js/js-base64.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.2/normalize.css" />
    <link rel="stylesheet" href="css/simplegrid.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body ng-controller="SystemTestsController">
    <div id="wrapper" class="grid grid-pad">


      <span class="section col-1-1">
        <span>Branch</span>
        <input ng-model="branch" ng-enter="reloadSuitesYaml()">

        <span>Configuration</span>
        <input disabled ng-model="configuration" id="configuration_input">

        <button disabled>Launch</button>

        <span class="push-right">
          <a href="" ng-click="descriptorOverview()">Descriptor Overview</a>
          <span>|</span>
          <a href="" ng-click="reset()">Reset</a>
        </span>
      </span>
      <textarea readonly
                class="section col-1-1"
                ng-model="descriptor">
      </textarea>

      <div class="section col-1-1">
        <div class="col-1-2">
          <h1>Suites</h1>
          <div ng-repeat="s in suites.available track by s.name"
               class="item">
            <a href="" ng-click="calculate(s)"
                       ng-mouseenter="overview(s, true)"
                       ng-mouseleave="overview(s, false)">
              {{s.name}}
            </a>
          </div>
        </div>
        <div id="overview" class="col-1-2">
          <div ng-repeat="t in tests.all" id="{{t.type}}_{{t.name}}" class="hidden">
            <h1>{{t.name}}</h1>
            <ul><li ng-repeat="t2 in t.tests">
              {{t2}}
            </li></ul>
          </div>
          <div ng-repeat="s in suites.all" id="{{s.type}}_{{s.name}}" class="hidden">
            <h1>{{s.name}}</h1>
            <div><span>Configuration: </span><span>{{s.handler_configuration}}</span></div>
            <div><span>Environment: </span><span>{{s.env}}</span></div>
            <div>Tests:</div>
            <ul><li ng-repeat="t in s.tests">
              {{t}}
            </li></ul>
          </div>
          <div ng-repeat="c in configurations.all" id="{{c.type}}_{{c.name}}" class="hidden">
            <h1>{{c.name}}</h1>
            <div><span>Environment: </span><span>{{c.env}}</span></div>
            <div><span>Handler: </span><span>{{c.handler}}</span></div>
            <div><span>External: </span><span>{{c.external.repo || 'internal'}}</span></div>
            <div><span>Inputs: </span><span>{{c.inputs}}</span></div>
            <div><span>Manager Blueprint: </span><span>{{c.manager_blueprint}}</span></div>
            <div><span>Properties: </span><span>{{c.properties}}</span></div>
            <div><span>Providers: </span><span>{{c.bootstrap_using_providers || false}}</span></div>
          </div>
          <div id="input_descriptor" class="hidden">
            <div ng-repeat="s in suites.selected">
              <h1>{{s.name}}</h1>
              <div><span>Configuration: </span><span>{{s.handler_configuration}}</span></div>
              <div><span>Environment: </span><span>{{s.env}}</span></div>
              <div>Tests:</div>
              <ul><li ng-repeat="t in s.tests">
                {{t}}
              </li></ul>
            </div>
            <div ng-repeat="s in custom_suites">
              <h1>{{s.name}}</h1>
              <div><span>Configuration: </span><span>{{s.handler_configuration}}</span></div>
              <div><span>Environment: </span><span>{{s.env}}</span></div>
              <div>Tests:</div>
              <ul><span ng-repeat="t in s.tests">
                <li ng-repeat="t2 in t.tests">
                  {{t2}}
                </li>
              </span></ul>
            </div>
        </div>
      </div>

      <div class="section col-1-1">
        <div class="col-1-2">
          <h1>Configurations</h1>
          <div ng-repeat="c in configurations.available track by c.name"
               class="item {{c.class}}">
            <a href="" ng-click="calculate(c)"
                       ng-mouseenter="overview(c, true)"
                       ng-mouseleave="overview(c, false)">
                {{c.name}}
            </a>
          </div>
        </div>
        <div class="col-1-2">
          <div class="col-1-1">
            <h1>
              <span>Tests</span>
              <button ng-click="applyCustom()" class="push-right">Apply Custom</button>
            </h1>
            <input id="custom_tests_input"
                   ng-model="current_custom_tests"
                   ng-enter="addCustomTests()" class="col-1-1">
            <div ng-repeat="t in tests.available track by t.name"
                 class="item {{t.class}}">
              <a href="" ng-click="calculate(t)"
                         ng-mouseenter="overview(t, true)"
                         ng-mouseleave="overview(t, false)">
                 {{t.name}}
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="js/app.js"></script>
  </body>
</html>
